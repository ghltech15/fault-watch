---
phase: 02-content-export
plan: 01
type: standard
title: Content Infrastructure & Static Image Export
---

# Plan 02-01: Content Infrastructure & Static Image Export

## Objective

Set up content generation infrastructure and implement static image export for TikTok-ready 9:16 graphics.

**Purpose:** Establish the foundation for all content generation - folder structure, dependencies, base classes, and static image export.
**Output:** Working image export that creates branded 9:16 graphics from dashboard data.

## Execution Context

@./.claude/get-shit-done/workflows/execute-phase.md
@./.claude/get-shit-done/templates/summary.md

## Context

@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-ui-foundation/01-01-SUMMARY.md
@.planning/phases/01-ui-foundation/01-02-SUMMARY.md
@fault_watch.py

**Tech stack available:** Streamlit, Plotly, Python 3.11
**Established patterns:** CNN red (#e31837), typography scale, hero/headline/subhead hierarchy

**User Requirements (from discussion):**
- Output: Local folder (`./content-output/`)
- Triggers: Price thresholds, time-based, manual (Phase 02-03)
- Formats: Full video with audio (Phase 02-02)

## Tasks

<task type="auto">
  <name>Install content generation dependencies</name>
  <files>requirements.txt</files>
  <action>
    Add to requirements.txt:
    - Pillow>=10.0.0 (image processing, composition)
    - moviepy>=1.0.3 (video generation - for 02-02)
    - kaleido>=0.2.1 (Plotly static export)

    Create content-output/ directory with .gitkeep.
    Create content-output/images/ and content-output/videos/ subdirectories.

    Add content-output/*.mp4 and content-output/*.png to .gitignore (keep structure, ignore generated files).

    Run: pip install -r requirements.txt
  </action>
  <verify>
    python -c "from PIL import Image; import moviepy; import kaleido; print('OK')"
  </verify>
  <done>Dependencies installed, content-output/ directory structure created</done>
</task>

<task type="auto">
  <name>Create content generator module</name>
  <files>content_generator.py</files>
  <action>
    Create new file content_generator.py with:

    1. **ContentConfig dataclass:**
       - output_dir: Path = Path("./content-output")
       - image_width: int = 1080 (TikTok 9:16)
       - image_height: int = 1920
       - brand_color: str = "#e31837" (CNN red)
       - font_path: Optional[str] = None (use default)

    2. **ContentGenerator class:**
       - __init__(self, config: ContentConfig = None)
       - _ensure_dirs() - create output directories if missing
       - _get_timestamp() - returns formatted timestamp for filenames
       - generate_image(data: dict, template: str) -> Path
       - generate_video(data: dict, template: str, duration: int = 10) -> Path (stub for 02-02)

    3. **Template types (enum):**
       - PRICE_ALERT: Silver/gold price spike
       - COUNTDOWN: Days until deadline
       - BANK_CRISIS: Bank stock crash
       - DAILY_SUMMARY: End of day recap

    Keep generate_video as stub that raises NotImplementedError (implemented in 02-02).

    Use Pillow for image composition. No external fonts - use PIL's default.
  </action>
  <verify>
    python -c "from content_generator import ContentGenerator, ContentConfig; c = ContentGenerator(); print('OK')"
  </verify>
  <done>ContentGenerator class created with image generation foundation</done>
</task>

<task type="auto">
  <name>Implement 9:16 image templates</name>
  <files>content_generator.py</files>
  <action>
    Add image generation methods to ContentGenerator:

    1. **_create_base_canvas():**
       - 1080x1920 dark background (#0d0d0d)
       - Top gradient fade (brand color at 20% opacity)
       - Bottom watermark: "fault.watch" in small text

    2. **_draw_price_alert(canvas, data):**
       - Large asset name at top ("SILVER")
       - HUGE price in center ($XX.XX)
       - Change percentage with up/down arrow
       - Timestamp at bottom

    3. **_draw_countdown(canvas, data):**
       - "DEADLINE" label at top
       - Giant days number in center
       - "DAYS REMAINING" below
       - Target date and event name

    4. **_draw_bank_crisis(canvas, data):**
       - Bank name header
       - Stock price with dramatic % drop
       - "CRISIS" label with red background
       - Exposure/loss data

    5. **_draw_daily_summary(canvas, data):**
       - "DAILY RECAP" header
       - Key metrics in list format (Silver, Gold, MS, VIX)
       - Risk index with color coding
       - Date

    Use PIL.ImageDraw for text, PIL.ImageFont for sizing.
    Colors: background #0d0d0d, accent #e31837, text white, secondary #888.

    Save to content-output/images/{template}_{timestamp}.png
  </action>
  <verify>
    python -c "
from content_generator import ContentGenerator, TemplateType
c = ContentGenerator()
path = c.generate_image({'price': 89.50, 'change': 5.2, 'asset': 'SILVER'}, TemplateType.PRICE_ALERT)
print(f'Created: {path}')
from PIL import Image
img = Image.open(path)
print(f'Size: {img.size}')  # Should be (1080, 1920)
"
  </verify>
  <done>4 image templates working, generating 1080x1920 branded images</done>
</task>

## Verification

Before declaring plan complete:
- [ ] `pip install -r requirements.txt` succeeds
- [ ] content-output/ directory exists with images/ and videos/ subdirs
- [ ] ContentGenerator creates 1080x1920 images
- [ ] All 4 template types generate valid PNG files
- [ ] Images have branded styling (dark bg, red accent, watermark)

## Success Criteria

- Dependencies installed (Pillow, MoviePy, kaleido)
- Content output directory structure created
- ContentGenerator class with 4 working image templates
- Images are 1080x1920 (9:16 aspect ratio)
- Consistent branding matches dashboard (CNN red, dark theme)

## Output

After completion, create `.planning/phases/02-content-export/02-01-SUMMARY.md`
